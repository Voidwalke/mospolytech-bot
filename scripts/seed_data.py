#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–ó–∞–ø—É—Å–∫: python scripts/seed_data.py
"""
import asyncio
import sys
from pathlib import Path

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ –≤ path
sys.path.insert(0, str(Path(__file__).parent.parent))

from app.database import async_session, init_db
from app.database.models import (
    FAQCategory, FAQItem, Document, UserRole
)
from sqlalchemy import select


async def seed_faq():
    """–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ FAQ"""
    async with async_session() as session:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ
        result = await session.execute(select(FAQCategory))
        if result.scalars().first():
            print("FAQ –¥–∞–Ω–Ω—ã–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º...")
            return
        
        print("–°–æ–∑–¥–∞—ë–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ FAQ...")
        
        categories_data = [
            ("–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ", "schedule", "–í–æ–ø—Ä–æ—Å—ã –æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ –∑–∞–Ω—è—Ç–∏–π –∏ —ç–∫–∑–∞–º–µ–Ω–æ–≤", "üìÖ", 1),
            ("–°—Ç–∏–ø–µ–Ω–¥–∏–∏", "scholarship", "–í–æ–ø—Ä–æ—Å—ã –æ —Å—Ç–∏–ø–µ–Ω–¥–∏—è—Ö –∏ –≤—ã–ø–ª–∞—Ç–∞—Ö", "üí∞", 2),
            ("–ó–∞—á–∏—Å–ª–µ–Ω–∏–µ", "enrollment", "–í–æ–ø—Ä–æ—Å—ã –æ –∑–∞—á–∏—Å–ª–µ–Ω–∏–∏, –ø–µ—Ä–µ–≤–æ–¥–µ –∏ –æ—Ç—á–∏—Å–ª–µ–Ω–∏–∏", "üìù", 3),
            ("–ó–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏", "debts", "–í–æ–ø—Ä–æ—Å—ã –æ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—è—Ö", "üìö", 4),
            ("–ü—Ä–∞–∫—Ç–∏–∫–∞", "practice", "–í–æ–ø—Ä–æ—Å—ã –æ –ø—Ä–∞–∫—Ç–∏–∫–µ –∏ —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ", "üè¢", 5),
            ("–î–æ–∫—É–º–µ–Ω—Ç—ã", "documents", "–í–æ–ø—Ä–æ—Å—ã –æ —Å–ø—Ä–∞–≤–∫–∞—Ö –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö", "üìÑ", 6),
            ("–ü—Ä–∏–∫–∞–∑—ã", "orders", "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–∫–∞–∑–∞—Ö —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞", "üìú", 7),
            ("–ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å", "calendar", "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–º–µ—Å—Ç—Ä–∞—Ö –∏ –∫–∞–Ω–∏–∫—É–ª–∞—Ö", "üìÜ", 8),
        ]
        
        categories = {}
        for name, slug, description, icon, order in categories_data:
            cat = FAQCategory(
                name=name,
                slug=slug,
                description=description,
                icon=icon,
                order=order
            )
            session.add(cat)
            await session.flush()
            categories[slug] = cat
            print(f"  ‚úì {icon} {name}")
        
        print("\n–°–æ–∑–¥–∞—ë–º –≤–æ–ø—Ä–æ—Å—ã FAQ...")
        
        faq_items = [
            ("schedule", "–ì–¥–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π?", 
             "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å:\n\n"
             "1. –ù–∞ —Å–∞–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è: https://rasp.dmami.ru\n"
             "2. –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ: https://e.mospolytech.ru\n"
             "3. –í –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ú–æ—Å–ü–æ–ª–∏—Ç–µ—Ö–∞",
             "—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –∑–∞–Ω—è—Ç–∏—è, –ø–∞—Ä—ã"),
            
            ("scholarship", "–ö–∞–∫–∏–µ –≤–∏–¥—ã —Å—Ç–∏–ø–µ–Ω–¥–∏–π —Å—É—â–µ—Å—Ç–≤—É—é—Ç?",
             "–í –ú–æ—Å–ü–æ–ª–∏—Ç–µ—Ö–µ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∏–¥–æ–≤ —Å—Ç–∏–ø–µ–Ω–¥–∏–π:\n\n"
             "‚Ä¢ –ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∞—è —Å—Ç–∏–ø–µ–Ω–¥–∏—è\n"
             "‚Ä¢ –ü–æ–≤—ã—à–µ–Ω–Ω–∞—è –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∞—è —Å—Ç–∏–ø–µ–Ω–¥–∏—è\n"
             "‚Ä¢ –°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç–∏–ø–µ–Ω–¥–∏—è\n"
             "‚Ä¢ –ò–º–µ–Ω–Ω—ã–µ —Å—Ç–∏–ø–µ–Ω–¥–∏–∏",
             "—Å—Ç–∏–ø–µ–Ω–¥–∏—è, –¥–µ–Ω—å–≥–∏, –≤—ã–ø–ª–∞—Ç—ã"),
            
            ("documents", "–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Å–ø—Ä–∞–≤–∫—É –æ–± –æ–±—É—á–µ–Ω–∏–∏?",
             "–°–ø—Ä–∞–≤–∫—É –º–æ–∂–Ω–æ –∑–∞–∫–∞–∑–∞—Ç—å:\n"
             "1. –û–Ω–ª–∞–π–Ω —á–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç\n"
             "2. –õ–∏—á–Ω–æ –≤ –¥–µ–∫–∞–Ω–∞—Ç–µ\n\n"
             "–°—Ä–æ–∫: 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è",
             "—Å–ø—Ä–∞–≤–∫–∞, –æ–± –æ–±—É—á–µ–Ω–∏–∏"),
            
            ("debts", "–ö–∞–∫ —É–∑–Ω–∞—Ç—å —Å–≤–æ–∏ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏?",
             "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—è—Ö –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å:\n"
             "‚Ä¢ –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ ‚Üí –ó–∞—á—ë—Ç–Ω–∞—è –∫–Ω–∏–∂–∫–∞\n"
             "‚Ä¢ –ß–µ—Ä–µ–∑ –∑–∞–ø—Ä–æ—Å –≤ –¥–µ–∫–∞–Ω–∞—Ç",
             "–∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å, –¥–æ–ª–≥, –ø–µ—Ä–µ—Å–¥–∞—á–∞"),
            
            ("practice", "–ö–æ–≥–¥–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞?",
             "–°—Ä–æ–∫–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:\n"
             "‚Ä¢ –£—á–µ–±–Ω–∞—è: 2-4 —Å–µ–º–µ—Å—Ç—Ä\n"
             "‚Ä¢ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è: 4-6 —Å–µ–º–µ—Å—Ç—Ä\n"
             "‚Ä¢ –ü—Ä–µ–¥–¥–∏–ø–ª–æ–º–Ω–∞—è: –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–µ–º–µ—Å—Ç—Ä",
             "–ø—Ä–∞–∫—Ç–∏–∫–∞, –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è"),
            
            ("calendar", "–ö–æ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –∫–∞–Ω–∏–∫—É–ª—ã?",
             "–ü—Ä–∏–º–µ—Ä–Ω—ã–µ —Å—Ä–æ–∫–∏:\n"
             "‚Ä¢ –ó–∏–º–Ω–∏–µ: –∫–æ–Ω–µ—Ü —è–Ω–≤–∞—Ä—è (2 –Ω–µ–¥–µ–ª–∏)\n"
             "‚Ä¢ –õ–µ—Ç–Ω–∏–µ: –∏—é–ª—å-–∞–≤–≥—É—Å—Ç (2 –º–µ—Å—è—Ü–∞)",
             "–∫–∞–Ω–∏–∫—É–ª—ã, –æ—Ç–¥—ã—Ö"),
        ]
        
        for cat_slug, question, answer, keywords in faq_items:
            item = FAQItem(
                category_id=categories[cat_slug].id,
                question=question,
                answer=answer,
                keywords=keywords
            )
            session.add(item)
            print(f"  ‚úì {question[:50]}...")
        
        await session.commit()
        print("\n‚úÖ FAQ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!")


async def seed_documents():
    """–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"""
    async with async_session() as session:
        result = await session.execute(select(Document))
        if result.scalars().first():
            print("–î–æ–∫—É–º–µ–Ω—Ç—ã —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º...")
            return
        
        print("–°–æ–∑–¥–∞—ë–º –¥–æ–∫—É–º–µ–Ω—Ç—ã...")
        
        documents = [
            ("–ó–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π –æ—Ç–ø—É—Å–∫", "applications", 
             "–ë–ª–∞–Ω–∫ –∑–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç–ø—É—Å–∫–∞",
             None, "https://mospolytech.ru/docs/akad_otpusk.docx", "docx"),
            
            ("–ó–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥", "applications",
             "–ë–ª–∞–Ω–∫ –∑–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ –¥—Ä—É–≥–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/—Ñ–∞–∫—É–ª—å—Ç–µ—Ç",
             None, "https://mospolytech.ru/docs/perevod.docx", "docx"),
            
            ("–ó–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—É—é –ø–æ–º–æ—â—å", "applications",
             "–ë–ª–∞–Ω–∫ –∑–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–π –ø–æ–º–æ—â–∏",
             None, "https://mospolytech.ru/docs/mat_pomosh.docx", "docx"),
            
            ("–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å –õ–ö", "instructions",
             "–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ª–∏—á–Ω—ã–º –∫–∞–±–∏–Ω–µ—Ç–æ–º —Å—Ç—É–¥–µ–Ω—Ç–∞",
             None, "https://mospolytech.ru/docs/lk_manual.pdf", "pdf"),
            
            ("–ü–æ–ª–æ–∂–µ–Ω–∏–µ –æ —Å—Ç–∏–ø–µ–Ω–¥–∏—è—Ö", "regulations",
             "–ü–æ–ª–æ–∂–µ–Ω–∏–µ –æ —Å—Ç–∏–ø–µ–Ω–¥–∏–∞–ª—å–Ω–æ–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤",
             None, "https://mospolytech.ru/docs/stipendii.pdf", "pdf"),
        ]
        
        for name, category, description, file_id, file_url, file_type in documents:
            doc = Document(
                name=name,
                category=category,
                description=description,
                file_id=file_id,
                file_url=file_url,
                file_type=file_type
            )
            session.add(doc)
            print(f"  ‚úì {name}")
        
        await session.commit()
        print("\n‚úÖ –î–æ–∫—É–º–µ–Ω—Ç—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!")


async def main():
    print("=" * 50)
    print("üéì –ú–æ—Å–ü–æ–ª–∏—Ç–µ—Ö –ë–æ—Ç - –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö")
    print("=" * 50)
    print()
    
    print("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...")
    await init_db()
    print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞\n")
    
    await seed_faq()
    print()
    await seed_documents()
    
    print()
    print("=" * 50)
    print("‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!")
    print("=" * 50)


if __name__ == "__main__":
    asyncio.run(main())

